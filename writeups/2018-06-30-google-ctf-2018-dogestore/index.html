<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>DOGESTORE - Google CTF 2018 &#183; mhackeroni</title><meta name=title content="DOGESTORE - Google CTF 2018 &#183; mhackeroni"><meta name=description content="Write-up for the DOGESTORE challenge from Google CTF 2018."><meta name=keywords content="google,ctf,crypto,mhackeroni,"><link rel=canonical href=https://mhackeroni.it/writeups/2018-06-30-google-ctf-2018-dogestore/><link type=text/css rel=stylesheet href=/css/main.bundle.min.1d8c7618f0ef6623fd6ebffc2988f58f128a919c43d2ed5d99a0621768c50d3ec37bd1e02b3eb119ba92bc64d53422281addaaa107a57202376dbd6a14e2e50e.css integrity="sha512-HYx2GPDvZiP9br/8KYj1jxKKkZxD0u1dmaBiF2jFDT7De9HgKz6xGbqSvGTVNCIoGt2qoQelcgI3bb1qFOLlDg=="><script type=text/javascript src=/js/appearance.min.2a7f28406ff67c2e3fedcfa49ff1dc78cca5f4b2ace4618a279f94d3fd241566af610abcf38bb98ec3f039afc0acbb3c27e9eced17e4a072f1a98e18a628ec7e.js integrity="sha512-Kn8oQG/2fC4/7c+kn/HceMyl9LKs5GGKJ5+U0/0kFWavYQq884u5jsPwOa/ArLs8J+ns7RfkoHLxqY4Ypijsfg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.a187118b41a60744310065c567365de85730c8495301d0ebae41810cc6f7a47432b1de7d4f3b11338959f1ac50c266be6b4b73acf6bf770016eb59b602cc1aa0.js integrity="sha512-oYcRi0GmB0QxAGXFZzZd6FcwyElTAdDrrkGBDMb3pHQysd59TzsRM4lZ8axQwma+a0tzrPa/dwAW61m2AswaoA==" data-copy=Copy data-copied=Copied></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://mhackeroni.it/writeups/2018-06-30-google-ctf-2018-dogestore/"><meta property="og:site_name" content="mhackeroni"><meta property="og:title" content="DOGESTORE - Google CTF 2018"><meta property="og:description" content="Write-up for the DOGESTORE challenge from Google CTF 2018."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2018-06-30T00:00:00+00:00"><meta property="article:modified_time" content="2018-06-30T00:00:00+00:00"><meta property="article:tag" content="Google"><meta property="article:tag" content="Ctf"><meta property="article:tag" content="Crypto"><meta property="article:tag" content="Mhackeroni"><meta name=twitter:card content="summary"><meta name=twitter:title content="DOGESTORE - Google CTF 2018"><meta name=twitter:description content="Write-up for the DOGESTORE challenge from Google CTF 2018."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"","name":"DOGESTORE - Google CTF 2018","headline":"DOGESTORE - Google CTF 2018","description":"Write-up for the DOGESTORE challenge from Google CTF 2018.","inLanguage":"en","url":"https:\/\/mhackeroni.it\/writeups\/2018-06-30-google-ctf-2018-dogestore\/","author":{"@type":"Person","name":"mhackeroni"},"copyrightYear":"2018","dateCreated":"2018-06-30T00:00:00\u002b00:00","datePublished":"2018-06-30T00:00:00\u002b00:00","dateModified":"2018-06-30T00:00:00\u002b00:00","keywords":["google","ctf","crypto","mhackeroni"],"mainEntityOfPage":"true","wordCount":"2735"}]</script><meta name=author content="mhackeroni"><link href=https://bsky.app/profile/mhackeroni.bsky.social rel=me><link href=https://www.facebook.com/mhackeroni rel=me><link href=https://github.com/mhackeroni/ rel=me><link href=https://www.linkedin.com/company/mhackeroni-inc/ rel=me><link href=https://x.com/mhackeroni rel=me><link href=https://www.youtube.com/@mhackeroni rel=me><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0"><div><a href=/ class=flex><span class=sr-only>mhackeroni</span>
<img src=/mhackeroni-stylized-square.webp width=1024 height=1024 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt=mhackeroni></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">mhackeroni</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/news/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>News</p></a><a href=/writeups/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Writeups</p></a><a href=/sponsors/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Sponsors>Sponsors</p></a><a href=/gallery/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title="ðŸ“·  Photo Gallery">Gallery</p></a><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title></p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/news/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>News</p></a></li><li class=mt-1><a href=/writeups/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Writeups</p></a></li><li class=mt-1><a href=/sponsors/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Sponsors>Sponsors</p></a></li><li class=mt-1><a href=/gallery/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title="ðŸ“·  Photo Gallery">Gallery</p></a></li><li class=mt-1><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title></p></a></li></ul></div></div></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">DOGESTORE - Google CTF 2018</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2018-06-30T00:00:00+00:00>30 June 2018</time><span class="px-2 text-primary-500">&#183;</span><span>2735 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">13 mins</span></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><div class="lead text-neutral-500 dark:text-neutral-400 !mb-9 text-xl">Authors: pietroferretti, chqmatteo</div><blockquote><p>Secret Cloud Storage System: This is a new system to store your end-to-end encrypted secrets. Now with SHA3 integrity checks!
$ nc dogestore.ctfcompetition.com 1337</p></blockquote><p>Attached we find:</p><ul><li><a href=/handouts/dogestore/fragment.rs><code>fragment.rs</code></a>, some partial Rust source code for the challenge;</li><li><a href=/handouts/dogestore/encrypted_secret><code>encrypted_secret</code></a>, a 110 bytes large binary file.</li></ul><h2 class="relative group">Understanding the challenge<div id=understanding-the-challenge class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#understanding-the-challenge aria-label=Anchor>#</a></span></h2><p>Let&rsquo;s start by taking a look at the Rust source code we were provided.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>const</span><span class=w> </span><span class=no>FLAG_SIZE</span>: <span class=kt>usize</span> <span class=o>=</span><span class=w> </span><span class=mi>56</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>const</span><span class=w> </span><span class=no>FLAG_DATA_SIZE</span>: <span class=kt>usize</span> <span class=o>=</span><span class=w> </span><span class=no>FLAG_SIZE</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cp>#[derive(Debug, Copy, Clone)]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>struct</span> <span class=nc>Unit</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>letter</span>: <span class=kt>u8</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>size</span>: <span class=kt>u8</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>deserialize</span><span class=p>(</span><span class=n>data</span>: <span class=kp>&amp;</span><span class=nb>Vec</span><span class=o>&lt;</span><span class=kt>u8</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Vec</span><span class=o>&lt;</span><span class=n>Unit</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>secret</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Vec</span>::<span class=n>new</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>letter</span><span class=p>,</span><span class=w> </span><span class=n>size</span><span class=p>)</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>data</span><span class=p>.</span><span class=n>iter</span><span class=p>().</span><span class=n>tuples</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>secret</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>Unit</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>letter</span>: <span class=o>*</span><span class=n>letter</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>size</span>: <span class=o>*</span><span class=n>size</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>secret</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>decode</span><span class=p>(</span><span class=n>data</span>: <span class=kp>&amp;</span><span class=nb>Vec</span><span class=o>&lt;</span><span class=n>Unit</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Vec</span><span class=o>&lt;</span><span class=kt>u8</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Vec</span>::<span class=n>new</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=o>&amp;</span><span class=n>Unit</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>letter</span><span class=p>,</span><span class=w> </span><span class=n>size</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>data</span><span class=p>.</span><span class=n>iter</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>res</span><span class=p>.</span><span class=n>extend</span><span class=p>(</span><span class=fm>vec!</span><span class=p>[</span><span class=n>letter</span><span class=p>;</span><span class=w> </span><span class=n>size</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>usize</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>].</span><span class=n>iter</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>res</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>data</span>: <span class=kp>&amp;</span><span class=nb>Vec</span><span class=o>&lt;</span><span class=kt>u8</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Vec</span><span class=o>&lt;</span><span class=kt>u8</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>get_key</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>iv</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>get_iv</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>openssl</span>::<span class=n>symm</span>::<span class=n>decrypt</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>openssl</span>::<span class=n>symm</span>::<span class=n>Cipher</span>::<span class=n>aes_256_ctr</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&amp;</span><span class=n>key</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nb>Some</span><span class=p>(</span><span class=o>&amp;</span><span class=n>iv</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>).</span><span class=n>unwrap</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>store</span><span class=p>(</span><span class=n>data</span>: <span class=kp>&amp;</span><span class=nb>Vec</span><span class=o>&lt;</span><span class=kt>u8</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>String</span> <span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>assert!</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>data</span><span class=p>.</span><span class=n>len</span><span class=p>()</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=no>FLAG_DATA_SIZE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=s>&#34;Wrong data size ({} vs {})&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>data</span><span class=p>.</span><span class=n>len</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=no>FLAG_DATA_SIZE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>decrypted</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>decrypt</span><span class=p>(</span><span class=n>data</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>secret</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>deserialize</span><span class=p>(</span><span class=o>&amp;</span><span class=n>decrypted</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>expanded</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>decode</span><span class=p>(</span><span class=o>&amp;</span><span class=n>secret</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>base64</span>::<span class=n>encode</span><span class=p>(</span><span class=o>&amp;</span><span class=n>compute_sha3</span><span class=p>(</span><span class=o>&amp;</span><span class=n>expanded</span><span class=p>)[</span><span class=o>..</span><span class=p>])</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>As suggested by the name (<code>fragment.rs</code>), the source code is partial, but we can nonetheless understand what it&rsquo;s supposed to do.</p><p><code>store</code> is the function that calls all the other functions, and works like this:</p><ul><li>read 56*2 = 112 bytes,</li><li>&ldquo;decrypt&rdquo; the data,</li><li>&ldquo;deserialize&rdquo; the data,</li><li>&ldquo;decode&rdquo; the data,</li><li>return the SHA-3 hash of the result, encoded in base64.</li></ul><p>We try to interact with the service at <code>dogestore.ctfcompetition.com</code> to check if it works in a similar way.</p><p>The service reads exactly 110 bytes, and returns a base64-encoded string, which decodes to 32 bytes.</p><p>The service&rsquo;s behaviour seems to match the source code, except for reading 110 bytes instead of 112. Close enough to be FLAG_SIZE*2, but we guess the organizers messed something up and FLAG_SIZE is actually 55. Among the SHA-3 variants, 32 bytes means SHA-3-256 is probably the one used by the service.</p><p>The challenge emulates a service taking some encrypted, serialized data, restoring it back to original, and returning a checksum.</p><p>Let&rsquo;s dive more deeply in each function.</p><h3 class="relative group">Decryption<div id=decryption class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#decryption aria-label=Anchor>#</a></span></h3><p>This function decrypts the 110 bytes using AES-CTR (AES counter mode). We assume the IV and the key are fixed, since we can&rsquo;t supply them and the service is supposed to be deterministic.</p><h3 class="relative group">Deserialization<div id=deserialization class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#deserialization aria-label=Anchor>#</a></span></h3><p>This function parses and deserializes the decrypted data.</p><p><code>tuples()</code> is not defined, but we assume (looking at the Unit struct) that it iterates through the byte vector 2 bytes at a time. For each pair, the first byte is read as a &ldquo;letter&rdquo;, the second as a &ldquo;size&rdquo;.</p><h3 class="relative group">Decoding<div id=decoding class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#decoding aria-label=Anchor>#</a></span></h3><p>The deserialized data is then &ldquo;expanded&rdquo; back to original size like this: for each letter-size pair, repeat the letter <em>size</em>+1 times.</p><p>Let&rsquo;s see an example:</p><pre tabindex=0><code>input: &#39;A \x00 B \x04 C \x01&#39; (these are contiguous bytes)

A repeated 0+1=1 times
B repeated 4+1=5 times
C repeated 1+1=2 times

output: &#39;ABBBBBCC&#39;
</code></pre><p>We now know the format of the decrypted data: the data is like</p><pre tabindex=0><code>1 byte: letter
1 byte: size - 1
... repeated 55 times
total length = 55*2 = 110 bytes

Example: &#39;A\x00B\x04C\x01w\x00t\x02...&#39;
</code></pre><p>Since usually serialization tries to save as much space as possible, we expect each letter to be different from the previous one.</p><h3 class="relative group">Approach<div id=approach class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#approach aria-label=Anchor>#</a></span></h3><p><code>encrypted_secret</code> is 110 bytes long, same size as the service input. Looking at the filename, this is probably the serialized, encrypted flag.</p><p>Let&rsquo;s start by submitting the secret to the service.
The service sends back the SHA-3 hash of the decrypted secret:</p><p><code>ff1e690dea4fa3384cfb151e95abe92fde33e57d69d8c1f97107d0bbccf8a1d6</code></p><p>We can&rsquo;t do much with this, but it could be useful for some additional final checks.</p><p>To move to the actual attack, some crypto basics are needed.
Skip the next section if this stuff is old news for you.</p><h2 class="relative group">Crypto Background<div id=crypto-background class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#crypto-background aria-label=Anchor>#</a></span></h2><h3 class="relative group">SHA-3<div id=sha-3 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#sha-3 aria-label=Anchor>#</a></span></h3><p>SHA-3 is a cryptographic hashing function, i.e. a function that maps a message of arbitrary length to a fixed-size digest.</p><p>One of the main properties of a cryptographic hash function is that it is <em>non-invertible</em>: we can&rsquo;t recover the original message from a digest.
We&rsquo;ll have to find another way to find the secret.</p><h3 class="relative group">AES-CTR<div id=aes-ctr class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#aes-ctr aria-label=Anchor>#</a></span></h3><p>AES is a block cipher, but it can work in many different <em>modes of operation</em>.</p><p>AES-CTR specifically is a mode of operation which makes AES work like a <em>stream</em> cipher. Instead of encrypting a message block by block, we generate a continuous, unpredictable bitstream. The bitstream (also called keystream) is simply XOR-ed with the plaintext to generate the ciphertext.</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=AES-CTR srcset="/img/dogestore_writeup/ctr-encryption_hu_b6576b3684ffe158.png 330w,
/img/dogestore_writeup/ctr-encryption_hu_841b9f8fe4cc001b.png 660w,
/img/dogestore_writeup/ctr-encryption_hu_41809540ebe553b4.png 1280w" data-zoom-src=/img/dogestore_writeup/ctr-encryption.png src=/img/dogestore_writeup/ctr-encryption.png></figure></p><p>The keystream depends on both the IV (initialization vector, or nonce) and the key. In this challenge we assume the IV and the key are fixed, since we can&rsquo;t provide them and we expect the service to be deterministic.</p><p>This means that in this specific case the keystream is fixed, and AES-CTR is reduced to a simple XOR cipher.</p><p>Let&rsquo;s see an example. Consider as plaintext the string &ldquo;Wiki&rdquo; (01010111 01101001 01101011 01101001 in 8-bit ASCII).</p><p>Encryption with a XOR cipher and a sample keystream:</p><pre tabindex=0><code>   01010111 01101001 01101011 01101001  // plaintext
 âŠ• 11110011 01100011 11101001 00110010  // keystream
 = 10100100 00001010 10000010 01011011  // ciphertext
</code></pre><p>Decryption is done by XOR-ing the ciphertext with the keystream again:</p><pre tabindex=0><code>   10100100 00001010 10000010 01011011  // ciphertext
 âŠ• 11110011 01100011 11101001 00110010  // keystream
 = 01010111 01101001 01101011 01101001  // plaintext
</code></pre><h4 class="relative group">Attacks on AES-CTR<div id=attacks-on-aes-ctr class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#attacks-on-aes-ctr aria-label=Anchor>#</a></span></h4><p>Without integrity checks, AES-CTR is <em>malleable</em>. By manipulating the ciphertext, we can purposefully modify the plaintext it will be decrypted to, even if we don&rsquo;t know the plaintext itself.</p><p>This is because, since aes-ctr is equivalent to a simple XOR cipher, when we flip a bit in the ciphertext the bit will be flipped in the plaintext too!</p><p>Let&rsquo;s see an example. We take the same ciphertext as the previous example, and flip an arbitrary bit.</p><p><code>10100100 00001010 10000010 01011011 -> 10100100 00001010 1000001*1* 01011011</code></p><pre tabindex=0><code>   10100100 00001010 10000011 01011011  // modified ciphertext
 âŠ• 11110011 01100011 11101001 00110010  // keystream
 = 01010111 01101001 01101010 01101001  // new plaintext
</code></pre><p>The plaintext bit in the same position was flipped.</p><p><code>01010111 01101001 01101011 01101001 -> 01010111 01101001 0110101*0* 01101001</code></p><p>Decrypted plaintext: &ldquo;Wi<strong>j</strong>i&rdquo; instead of &ldquo;Wiki&rdquo;.</p><p>Since we know the format of the encrypted data, we can use this trick to our advantage to edit the plaintext in critical positions.</p><h2 class="relative group">Finding the letters<div id=finding-the-letters class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#finding-the-letters aria-label=Anchor>#</a></span></h2><p>Let&rsquo;s think about it. The only output the service is willing to give us is the hash of the decoded plaintext. We can&rsquo;t do much with it, except for checking if the hash is one we already know.
We need to use this hash to guess the content of the plaintext.</p><p>We can use the fact that two different serializations can be decoded to the same message: if the same letter appears twice in a row in the serialized data, as long as the sum of the sizes of the two repeated letters is the same, the decoded message will also be the same (and the hash will be too).</p><p>Example:</p><pre tabindex=0><code>&#39;A\x02A\x02&#39; is decoded as &#39;AAAAAA&#39;
&#39;A\x01A\x03&#39; is also decoded as &#39;AAAAAA&#39;
</code></pre><p>We will use this and some clever xor tricks to run automated tests on the plaintext values, and leak the content.</p><p>The attack:</p><ul><li>consider a pair of adjacent &ldquo;letters&rdquo; (i.e. letter 1 + size 1 + letter 2 + size 2)</li><li>XOR the second letter with the mask M</li><li>XOR the least significant bit of the size bytes in all the possible configurations (0 and 0, 0 and 1, 1 and 0, 1 and 1)<ul><li>if the letter are XORed to be the same, two of the four combinations will produce a message where the letter is repeated for the same total number of times, and therefore two hashes will match</li><li>if the letters are not XORed to be the same, no match will be found</li></ul></li><li>try XOR-ing with a different value M until a match is found (up to 256)</li><li>repeat for each pair of adjacent letters (from 1 to 55)</li></ul><p>When a match is found, we will have leaked the value M = letter 1 XOR letter 2.</p><p>Example:</p><pre tabindex=0><code>original plaintext: A\x03D\x05
if the letter is xor-ed correctly, the second letter will be the same as the first in the new plaintext:
...
xor 2 -&gt; A\x03C\x05

xor first size, xor second size -&gt; result
0,0 -&gt; A\x03C\x05 tot 10, decoded as AAAACCCCCC
0,1 -&gt; A\x03C\x04 tot 9,  decoded as AAAACCCCC
1,0 -&gt; A\x02C\x05 tot 9,  decoded as AAACCCCCC
1,1 -&gt; A\x02C\x04 tot 8,  decoded as AAACCCCC
*no match*

xor 3 -&gt; A\x03A\x05

xor first size, xor second size -&gt; result
0,0 -&gt; A\x03A\x05 tot 10, decoded as AAAAAAAAAA
0,1 -&gt; A\x03A\x04 tot 9,  decoded as AAAAAAAAA *match*
1,0 -&gt; A\x02A\x05 tot 9,  decoded as AAAAAAAAA *match*
1,1 -&gt; A\x02A\x04 tot 8,  decoded as AAAAAAAA
</code></pre><p>We can prove that, if the next letter is xor-ed to be the same as the current, at least two of the four hashes will be the same. There is always a combination that makes the size increase or decrease by the same amount.
Size variation for each xor bit combination:</p><table><thead><tr><th></th><th>0,0</th><th>0,1</th><th>1,0</th><th>1,1</th></tr></thead><tbody><tr><td>0,0</td><td>+0</td><td><strong>+1</strong></td><td><strong>+1</strong></td><td>+2</td></tr><tr><td>0,1</td><td><strong>+0</strong></td><td>-1</td><td>+1</td><td><strong>+0</strong></td></tr><tr><td>1,0</td><td><strong>+0</strong></td><td>+1</td><td>-1</td><td><strong>+0</strong></td></tr><tr><td>1,1</td><td>+0</td><td><strong>-1</strong></td><td><strong>-1</strong></td><td>-2</td></tr></tbody></table><p>On the y axis, we have the lsb of the size bytes for the first and second letter.
On the x axis, the possible xor combinations.</p><p>Using this attack we can find all the bitwise differences between adjacent letters. Since we don&rsquo;t know the value of the first letter, we will have to try all of them and guess which is the one that makes more sense. All the other letters can be found using the first value and the differences.</p><p>The exploit:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>socket</span> <span class=kn>import</span> <span class=n>socket</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>sha3_256</span> <span class=k>as</span> <span class=n>sha3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>bxor</span><span class=p>(</span><span class=n>b1</span><span class=p>,</span> <span class=n>b2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>parts</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>b1</span><span class=p>,</span> <span class=n>b2</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>b1</span><span class=p>,</span> <span class=n>b2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>parts</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>bytes</span><span class=p>([</span><span class=n>b1</span> <span class=o>^</span> <span class=n>b2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gethash</span><span class=p>(</span><span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># send text</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span> <span class=o>=</span> <span class=n>socket</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span><span class=o>.</span><span class=n>connect</span><span class=p>((</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># get base64 encoded hash</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>sock</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>host</span> <span class=o>=</span> <span class=s1>&#39;dogestore.ctfcompetition.com&#39;</span>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=mi>1337</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># load encrypted flag</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;encrypted_secret&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ctext</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Encrypted:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>ctext</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>ctext</span><span class=p>),</span> <span class=s1>&#39;bytes&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>nletters</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>ctext</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>differences</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>nletters</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;index:&#39;</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;diff:&#39;</span><span class=p>,</span> <span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>hashes</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=ow>in</span> <span class=p>((</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=c1># a) xor next letter to make it the same as the current one</span>
</span></span><span class=line><span class=cl>            <span class=c1># b) xor least significant bit of the sizes to create two messages</span>
</span></span><span class=line><span class=cl>            <span class=c1># with varying sizes for the current and following letter,</span>
</span></span><span class=line><span class=cl>            <span class=c1># but same total size</span>
</span></span><span class=line><span class=cl>            <span class=n>mask</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00\x00</span><span class=s1>&#39;</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> \
</span></span><span class=line><span class=cl>                   <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;little&#39;</span><span class=p>)</span> <span class=o>+</span> \
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=n>c</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;little&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;little&#39;</span><span class=p>)</span> <span class=o>+</span> \
</span></span><span class=line><span class=cl>                   <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00\x00</span><span class=s1>&#39;</span> <span class=o>*</span> <span class=p>(</span><span class=n>nletters</span> <span class=o>-</span> <span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>mask</span><span class=p>)</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>ctext</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>h</span> <span class=o>=</span> <span class=n>gethash</span><span class=p>(</span><span class=n>bxor</span><span class=p>(</span><span class=n>ctext</span><span class=p>,</span> <span class=n>mask</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>hashes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># if we found a match among the hashes, the letters were the same, and</span>
</span></span><span class=line><span class=cl>        <span class=c1># we guessed the bit difference between this letter and the next one</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>hashes</span><span class=p>))</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Nice!&#39;</span><span class=p>,</span> <span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>differences</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>differences</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>256</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>differences</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span> <span class=o>^</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span></span></code></pre></div><p>Among the possible candidates, we notice one that follows the ctf flag format:</p><pre tabindex=0><code>...
72
HFHFHDHDHDSAaACTF{SADASDSDCTF{L_E_R_OY_JENKINS}ASDCTF{
...
</code></pre><p>Sadly we still don&rsquo;t know how many times each letter is repeated in the actual decoded data.</p><h2 class="relative group">Finding the sizes<div id=finding-the-sizes class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#finding-the-sizes aria-label=Anchor>#</a></span></h2><p>We can mount an attack similar to the previous, but this time we have the advantage of knowing the value of the letters themselves.</p><p>Again, we exploit the case where two different serializations are decoded to the same message.</p><p>The attack:</p><ul><li>consider a pair of adjacent &ldquo;letters&rdquo; (i.e. letter 1 + size 1 + letter 2 + size 2)</li><li>XOR the second letter with the mask M we know to make the letters the same</li><li>consider a bit position in both &ldquo;size&rdquo; bytes (e.g. the first bit)</li><li>flip the bit in the first size byte, get the resulting hash</li><li>flip the bit in the second size byte, get the resulting hash</li><li>if the bits were the same, both messages will have the letter repeated the same amount of times, and therefore the same hashes</li><li>if the bits were opposite, the letter will appear a different amount of times and the hashes will be different</li><li>repeat for each bit position in the size bytes (from 1 to 8)</li><li>repeat for each pair of adjacent letters (from 1 to 55)</li></ul><p>With this attack we can recover M&rsquo; = size 1 XOR size 2, one bit at a time.</p><p>Example:</p><pre tabindex=0><code>original plaintext: A\x03D\x02
xor to make the letters match -&gt; A\x03A\x02

bit 1:
-&gt; A\x02A\x02, tot 6, decoded as AAAAAA
-&gt; A\x03A\x03, tot 8, decoded as AAAAAAAA
*no match*
the bits are different

bit 2:
-&gt; A\x01A\x02, tot 5, decoded as AAAAA
-&gt; A\x03A\x00, tot 5, decoded as AAAAA
*match*
the bits are the same
...
</code></pre><p>The exploit:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>socket</span> <span class=kn>import</span> <span class=n>socket</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>sha3_256</span> <span class=k>as</span> <span class=n>sha3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>bxor</span><span class=p>(</span><span class=n>b1</span><span class=p>,</span> <span class=n>b2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>parts</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>b1</span><span class=p>,</span> <span class=n>b2</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>b1</span><span class=p>,</span> <span class=n>b2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>parts</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>bytes</span><span class=p>([</span><span class=n>b1</span> <span class=o>^</span> <span class=n>b2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gethash</span><span class=p>(</span><span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># send text</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span> <span class=o>=</span> <span class=n>socket</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span><span class=o>.</span><span class=n>connect</span><span class=p>((</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># get base64 encoded hash</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>sock</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>host</span> <span class=o>=</span> <span class=s1>&#39;dogestore.ctfcompetition.com&#39;</span>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=mi>1337</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>differences</span> <span class=o>=</span> <span class=p>[</span><span class=mi>14</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span>
</span></span><span class=line><span class=cl>               <span class=mi>61</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>61</span><span class=p>,</span> <span class=mi>55</span><span class=p>,</span> <span class=mi>19</span><span class=p>,</span> <span class=mi>26</span><span class=p>,</span> <span class=mi>26</span><span class=p>,</span>
</span></span><span class=line><span class=cl>               <span class=mi>13</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>22</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>29</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span>
</span></span><span class=line><span class=cl>               <span class=mi>23</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>61</span><span class=p>,</span> <span class=mi>113</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># load encrypted flag</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;encrypted_secret&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ctext</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Encrypted:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>ctext</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>ctext</span><span class=p>),</span> <span class=s1>&#39;bytes&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>nletters</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>ctext</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sizes</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>nletters</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;index:&#39;</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>8</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;bit&#39;</span><span class=p>,</span> <span class=n>j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># check if this bit in the current size byte is different from the one</span>
</span></span><span class=line><span class=cl>        <span class=c1># in the following size byte</span>
</span></span><span class=line><span class=cl>        <span class=c1># first mask: make letters the same,</span>
</span></span><span class=line><span class=cl>        <span class=c1>#             change one bit in the size of the first letter</span>
</span></span><span class=line><span class=cl>        <span class=n>mask1</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00\x00</span><span class=s1>&#39;</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> \
</span></span><span class=line><span class=cl>                <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=p>(</span><span class=mi>1</span><span class=o>&lt;&lt;</span><span class=n>j</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;little&#39;</span><span class=p>)</span> <span class=o>+</span> \
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>differences</span><span class=p>[</span><span class=n>i</span><span class=p>])</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;little&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span> <span class=o>+</span> \
</span></span><span class=line><span class=cl>                <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00\x00</span><span class=s1>&#39;</span> <span class=o>*</span> <span class=p>(</span><span class=n>nletters</span> <span class=o>-</span> <span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>mask1</span><span class=p>)</span> <span class=o>==</span> <span class=mi>110</span>
</span></span><span class=line><span class=cl>        <span class=n>h1</span> <span class=o>=</span> <span class=n>gethash</span><span class=p>(</span><span class=n>bxor</span><span class=p>(</span><span class=n>ctext</span><span class=p>,</span> <span class=n>mask1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1># second mask: make letters the same,</span>
</span></span><span class=line><span class=cl>        <span class=c1>#              change one bit in the size of the second letter</span>
</span></span><span class=line><span class=cl>        <span class=n>mask2</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00\x00</span><span class=s1>&#39;</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> \
</span></span><span class=line><span class=cl>                <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00\x00</span><span class=s1>&#39;</span> <span class=o>+</span> \
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>differences</span><span class=p>[</span><span class=n>i</span><span class=p>])</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;little&#39;</span><span class=p>)</span> <span class=o>+</span> \
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=mi>1</span><span class=o>&lt;&lt;</span><span class=n>j</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;little&#39;</span><span class=p>)</span> <span class=o>+</span> \
</span></span><span class=line><span class=cl>                <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00\x00</span><span class=s1>&#39;</span> <span class=o>*</span> <span class=p>(</span><span class=n>nletters</span> <span class=o>-</span> <span class=n>i</span> <span class=o>-</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>mask2</span><span class=p>)</span> <span class=o>==</span> <span class=mi>110</span>
</span></span><span class=line><span class=cl>        <span class=n>h2</span> <span class=o>=</span> <span class=n>gethash</span><span class=p>(</span><span class=n>bxor</span><span class=p>(</span><span class=n>ctext</span><span class=p>,</span> <span class=n>mask2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1># if the bits are the same, the size will be increased by the same</span>
</span></span><span class=line><span class=cl>        <span class=c1># amount for both letters</span>
</span></span><span class=line><span class=cl>        <span class=c1># -&gt; same hash</span>
</span></span><span class=line><span class=cl>        <span class=c1># otherwise  one size will be increased, the other decreased</span>
</span></span><span class=line><span class=cl>        <span class=c1># -&gt; different hashes</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>h1</span> <span class=o>==</span> <span class=n>h2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;same&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;different&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>b</span> <span class=o>+=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=n>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sizes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>sizes</span><span class=p>)</span>
</span></span></code></pre></div><p>Using this exploit we manage to find the bitwise differences between the sizes of each letter.</p><p>Again, we don&rsquo;t know the first value, but we guess the one with the smallest values is the most probable.</p><h2 class="relative group">Flag<div id=flag class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#flag aria-label=Anchor>#</a></span></h2><p>{% raw %}
With the leaked letters and sizes, we can recover the decoded secret, which is <code>'HFHFHHHDHDHDDDDDDSSSSSSSAAAAaAAAAAACTF{{{SADASDSDCTF{LLLLLLLLL___EEEEE____RRRRRRRRRRR_OYYYYYYYYYY_JEEEEEEENKKKINNSSS}ASDDDDDDDCTF{{{{{\n'</code>.
{% endraw %}</p><p>The sha3 hash of the secret we found is <code>ff1e690dea4fa3384cfb151e95abe92fde33e57d69d8c1f97107d0bbccf8a1d6</code>, which matches with the one provided by the server! We&rsquo;re all set.</p><p>The flag is the portion following this ctf&rsquo;s flag format, i.e. <code>CTF{LLLLLLLLL___EEEEE____RRRRRRRRRRR_OYYYYYYYYYY_JEEEEEEENKKKINNSSS}</code>.</p><h2 class="relative group">Additional notes<div id=additional-notes class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href=#additional-notes aria-label=Anchor>#</a></span></h2><p>This challenge was fun, as there were many different way to leak the plaintext content.</p><p>For instance, an alternative way to leak the sizes came to our mind after the ctf was finished.</p><p>Once we knew the letters, we could just XOR all letters to the same one and get the resulting hash. We could then locally compute the hash of that letter repeated for all possible lengths, and look for a match to find the sum of all the sizes.</p><p>The single values could next be found by xoring a letter at a time, and again bruteforcing locally all possible combination of the repetitions of that letter, concatenated with the repetitions of the other letter.</p><p>This could have saved some requests to the challenge service, which was often slow while the ctf was running (probably due to high load).</p></div></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_writeups/2018-06-30-google-ctf-2018-dogestore/index.md data-oid-likes=likes_writeups/2018-06-30-google-ctf-2018-dogestore/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/writeups/2018-06-30-google-ctf-2018-mitm/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">MITM - Google CTF 2018</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2018-06-30T00:00:00+00:00>30 June 2018</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/writeups/2018-07-08-wctf-2018-party/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Party - WCTF 2018</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2018-07-08T00:00:00+00:00>8 July 2018</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href title></a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
mhackeroni</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://mhackeroni.it/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>